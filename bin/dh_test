#!/home/azarakhsh/works/DemonHunter/test/bin/python3

import asyncio

from demonhunter import DemonHunter
from demonhunter.nodes.honeypots.telnet import TelnetHoneypot, MicrosoftTelnet
from demonhunter.nodes.honeypots.vnc import VNCHoneypot
from demonhunter.nodes.honeypots.http import HTTPHoneypot, Apache

def main():
    loop = asyncio.get_event_loop()

    hp = DemonHunter(loop)

    vnc = VNCHoneypot(logfile="vnc.log")
    hp.add_honeypot(vnc)

    telnet = TelnetHoneypot(handler=MicrosoftTelnet, port=8023, logfile="telnet.log")
    hp.add_honeypot(telnet)

    http = HTTPHoneypot(handler=Apache, port=8080, logfile="http.log")
    hp.add_honeypot(http)

    hp.start()

    try:
        print("DemonHunter demo started ...")
        print("This demo contains Microsoft Telnet on 0.0.0.0:8023 and it logs in ./telnet.log")
        print("And Standard VNC on 0.0.0.0:5900 and it logs in ./vnc.log")
        print("And Apache webserver on 0.0.0.0:8080 and it logs in ./http.log")
        loop.run_forever()
    except KeyboardInterrupt:
        hp.stop()
        print("\nServer Closed")

    loop.close()

if __name__ == '__main__':
    main()